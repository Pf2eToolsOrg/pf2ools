class d{constructor(t){this.children=[],this.parent=t}delete(t){const i=this.children.indexOf(t);return i===-1?!1:(this.children=this.children.slice(0,i).concat(this.children.slice(i+1)),this.children.length===0&&this.parent.delete(this),!0)}add(t){return this.children.push(t),this}}class l{constructor(t){this.parent=null,this.children={},this.parent=t||null}get(t){return this.children[t]}insert(t){let i=this;for(let s=0;s<t.length;s+=1){const r=t[s];let n=i.get(r);if(s===t.length-1)return n instanceof l&&(i.delete(n),n=null),n||(n=new d(i),i.children[r]=n),n;n instanceof d&&(n=null),n||(n=new l(i),i.children[r]=n),i=n}return i}delete(t){for(const i in this.children)if(this.children[i]===t){const r=delete this.children[i];return Object.keys(this.children).length===0&&this.parent&&this.parent.delete(this),r}return!1}}function u(e){if(!(e instanceof HTMLElement))return!1;const t=e.nodeName.toLowerCase(),i=(e.getAttribute("type")||"").toLowerCase();return t==="select"||t==="textarea"||t==="input"&&i!=="submit"&&i!=="reset"&&i!=="checkbox"&&i!=="radio"||e.isContentEditable}function T(e,t){const i=new CustomEvent("hotkey-fire",{cancelable:!0,detail:{path:t}});e.dispatchEvent(i)&&(u(e)?e.focus():e.click())}function E(e){return e.split(",").map(t=>t.split(" "))}function k(e){const t=e.code.startsWith("Key")&&e.shiftKey&&e.key.toUpperCase()===e.key;return`${e.ctrlKey?"Control+":""}${e.altKey?"Alt+":""}${e.metaKey?"Meta+":""}${e.shiftKey&&!t?"Shift+":""}${e.key}`}const o=new l,m=new WeakMap;let f=o,c=null,y=[];function h(){y=[],c=null,f=o}function b(e){if(e.defaultPrevented||!(e.target instanceof Node))return;if(u(e.target)){const i=e.target;if(!i.id||!i.ownerDocument.querySelector(`[data-hotkey-scope="${i.id}"]`))return}c!=null&&window.clearTimeout(c),c=window.setTimeout(h,1500);const t=f.get(k(e));if(!t){h();return}if(y.push(k(e)),f=t,t instanceof d){const i=e.target;let s=!1,r;const n=u(i);for(let a=t.children.length-1;a>=0;a-=1){r=t.children[a];const p=r.getAttribute("data-hotkey-scope");if(!n&&!p||n&&i.id===p){s=!0;break}}r&&s&&(T(r,y),e.preventDefault()),h()}}function x(e,t){Object.keys(o.children).length===0&&document.addEventListener("keydown",b);const s=E(t||e.getAttribute("data-hotkey")||"").map(r=>o.insert(r).add(e));m.set(e,s)}function g(e){const t=m.get(e);if(t&&t.length)for(const i of t)i&&i.delete(e);Object.keys(o.children).length===0&&document.removeEventListener("keydown",b)}const w=(e,t)=>{e.dataset.hotkey=t,x(e)},L=(e,t)=>(w(e,t),{update:i=>{e.dataset.hotkey&&g(e),i?w(e,i):delete e.dataset.hotkey},destroy:()=>{g(e)}});export{L as h};
