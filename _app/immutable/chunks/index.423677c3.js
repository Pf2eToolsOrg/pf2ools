class h{constructor(t){this.children=[],this.parent=t}delete(t){const n=this.children.indexOf(t);return n===-1?!1:(this.children=this.children.slice(0,n).concat(this.children.slice(n+1)),this.children.length===0&&this.parent.delete(this),!0)}add(t){return this.children.push(t),this}}class l{constructor(t){this.parent=null,this.children={},this.parent=t||null}get(t){return this.children[t]}insert(t){let n=this;for(let s=0;s<t.length;s+=1){const r=t[s];let i=n.get(r);if(s===t.length-1)return i instanceof l&&(n.delete(i),i=null),i||(i=new h(n),n.children[r]=i),i;i instanceof h&&(i=null),i||(i=new l(n),n.children[r]=i),n=i}return n}delete(t){for(const n in this.children)if(this.children[n]===t){const r=delete this.children[n];return Object.keys(this.children).length===0&&this.parent&&this.parent.delete(this),r}return!1}}function u(e){if(!(e instanceof HTMLElement))return!1;const t=e.nodeName.toLowerCase(),n=(e.getAttribute("type")||"").toLowerCase();return t==="select"||t==="textarea"||t==="input"&&n!=="submit"&&n!=="reset"&&n!=="checkbox"&&n!=="radio"||e.isContentEditable}function m(e,t){const n=new CustomEvent("hotkey-fire",{cancelable:!0,detail:{path:t}});e.dispatchEvent(n)&&(u(e)?e.focus():e.click())}function b(e){return e.split(",").map(t=>t.split(" "))}function g(e){const t=e.code.startsWith("Key")&&e.shiftKey&&e.key.toUpperCase()===e.key;return`${e.ctrlKey?"Control+":""}${e.altKey?"Alt+":""}${e.metaKey?"Meta+":""}${e.shiftKey&&!t?"Shift+":""}${e.key}`}const o=new l,k=new WeakMap;let f=o,c=null,y=[];function d(){y=[],c=null,f=o}function w(e){if(e.defaultPrevented||!(e.target instanceof Node))return;if(u(e.target)){const n=e.target;if(!n.id||!n.ownerDocument.querySelector(`[data-hotkey-scope="${n.id}"]`))return}c!=null&&window.clearTimeout(c),c=window.setTimeout(d,1500);const t=f.get(g(e));if(!t){d();return}if(y.push(g(e)),f=t,t instanceof h){const n=e.target;let s=!1,r;const i=u(n);for(let a=t.children.length-1;a>=0;a-=1){r=t.children[a];const p=r.getAttribute("data-hotkey-scope");if(!i&&!p||i&&n.id===p){s=!0;break}}r&&s&&(m(r,y),e.preventDefault()),d()}}function T(e,t){Object.keys(o.children).length===0&&document.addEventListener("keydown",w);const s=b(t||e.getAttribute("data-hotkey")||"").map(r=>o.insert(r).add(e));k.set(e,s)}function E(e){const t=k.get(e);if(t&&t.length)for(const n of t)n&&n.delete(e);Object.keys(o.children).length===0&&document.removeEventListener("keydown",w)}export{T as i,E as u};
